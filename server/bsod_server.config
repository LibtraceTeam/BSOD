# Source URI for libtrace.
# eg: rtclient:name-of-rt-server:port
#     erf:/path/to/erf.trace
#     pcap:/path/to/pcap.trace
#     pcapint:eth0

source "pcap:/path/to/pcap.trace"

# this is the port that bsod_server will listen on for clients
# It is the only config option that isn't reparsed
listenport 32500

background 0
pidfile "/tmp/bsod.pid"


# BPF style filter to apply to the source URI. Works on any URI, but
# is only tested on ethernets
#filter "tcp"

# show SYN packets, unless they have the ACK bit set
# You'll need to set shownodata 1, and probably want to set showdata 0
#filter "(tcp[13] &2 = 2) and (tcp[13] &16 = 0)"

# show DNS traffic only
#filter "port 80"
#filter "tcp and port 10000"

#filter "not tcp and not udp"
## Dynamically loaded modules for each of colour map, right position
## left position, and direction
#colour_module "plugins/colour/colours.so"
## lpos is the "local" ("left") side.
#lpos_module "plugins/position/network16.so"	
## rpos is the "remote" ("right") side
#rpos_module "plugins/position/radial.so"
#dir_module "plugins/direction/destmac.so"

## mac address file for use with the destmac dir_module
## MUST exist if using destmac - see documentation
#macaddrfile "/path/to/mac_addrs"

# Whether to loop when the source finishes
# - Offline traces only
loop 1

# Whether to show packets that contain no TCP or UDP payload (default 0) 
# - Applies to TCP or UDP packets only
shownondata 1

# Whether to show packets that contain TCP or UDP payload (default 1) 
# - Applies to TCP or UDP packets only
showdata 1

# Whether to show TCP control (syn, fin, rst) packets (default 1)
# - Applies to TCP packets only
# - Overrides the showdata and shownondata options
showcontrol 1

## if bsod isn't in /usr/local/bsod/, specify the base bsod directory
## (should contain the plugins dir etc)
## note the trailing slash
#basedir "/path/to/where/bsod/is/installed/"
